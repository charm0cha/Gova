<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Gova | Control Plane</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .glass-panel { background: rgba(255, 255, 255, 0.02); backdrop-filter: blur(15px); border: 1px solid rgba(255, 255, 255, 0.08); }
    </style>
</head>
<body class="bg-[#0f1115] text-gray-300 min-h-screen">

  <nav class="border-b border-white/5 bg-[#0f1115]/60 backdrop-blur-xl sticky top-0 z-50">
    <div class="max-w-7xl mx-auto px-8 py-4 flex justify-between items-center">
        <h1 class="text-xl font-bold text-white tracking-tighter">GOVA<span class="text-indigo-500">.</span></h1>
        
        <div class="flex items-center space-x-4">
            <a href="/auth/notify-managers" class="bg-amber-500/10 border border-amber-500/30 px-4 py-2 rounded-lg hover:bg-amber-500/20 transition group">
                <span class="text-[10px] font-bold text-amber-400 uppercase tracking-widest">Trigger 14-Day Alerts</span>
            </a>

            <a href="/auth/sync" class="bg-indigo-500/10 border border-indigo-500/30 px-4 py-2 rounded-lg hover:bg-indigo-500/20 transition group">
                <span class="text-[10px] font-bold text-indigo-400 uppercase tracking-widest">Sync Entra Directory</span>
            </a>

            <a href="/logout" class="text-[10px] font-mono text-gray-500 hover:text-red-400 uppercase tracking-widest border border-white/10 px-3 py-1 rounded-full transition">Logout</a>
        </div>
    </div>
</nav>

    <main class="max-w-7xl mx-auto px-8 py-12">
        <div class="glass-panel rounded-2xl overflow-hidden shadow-2xl">
            <table class="w-full text-left">
                <thead>
                    <tr class="bg-white/[0.03] text-[10px] font-bold uppercase tracking-widest text-gray-500 border-b border-white/5">
                        <th class="px-8 py-5">Name</th>
                        <th class="px-8 py-5">Unit</th>
                        <th class="px-8 py-5">Employee Type</th>
                        <th class="px-8 py-5">Location</th>
                        <th class="px-8 py-5">Line Manager</th>
                        <th class="px-8 py-5">Contract End</th>
                        <th class="px-8 py-5 text-right">Security</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-white/5">
                    {% for user in users %}
                    <tr class="hover:bg-white/[0.01] transition-colors">
                        <td class="px-8 py-6">
                            <div class="font-bold text-white">{{ user.full_name }}</div>
                            <div class="text-[11px] text-gray-600 font-mono">{{ user.email }}</div>
                        </td>
                        
                        <td class="px-8 py-6">
                            <span class="text-[10px] font-mono text-indigo-400 border border-indigo-500/20 px-2 py-0.5 rounded bg-indigo-500/5 uppercase">
                                {{ user.dept }}
                            </span>
                        </td>
                        
                        <td class="px-8 py-6 text-sm text-gray-400">{{ user.role }}</td>
                        
                        <td class="px-8 py-6 text-sm text-gray-400">
                            {{ user.display_location }}
                        </td>

                        <td class="px-8 py-6">
                            <div class="text-[10px] font-bold text-indigo-300 uppercase tracking-tighter">Supervisor:</div>
                            <div class="text-xs text-white">{{ user.display_manager }}</div>
                        </td>

                        <td class="px-8 py-6">
                            <div class="flex flex-col">
                                <span class="text-xs font-mono {% if user.is_expiring %}text-red-500 font-bold animate-pulse{% else %}text-gray-500{% endif %}">
                                    {{ user.contract_end.strftime('%Y-%m-%d') if user.contract_end else 'PERMANENT' }}
                                </span>
                                <span class="text-[9px] uppercase tracking-tighter text-gray-600">
                                    {% if user.is_expiring %} 
                                        ⚠️ Terminating in {{ user.days_left }}D 
                                    {% else %}
                                        Node Stable
                                    {% endif %}
                                </span>
                            </div>
                        </td>

                        <td class="px-8 py-6 text-right">
                            <form action="/delete/{{ user.id }}" method="post">
                                <button type="submit" class="text-[10px] text-red-500/40 hover:text-red-500 font-black uppercase tracking-tighter transition-all">
                                    [ REVOKE ]
                                </button>
                            </form>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </main>
</body>
</html>